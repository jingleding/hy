'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _index = require('E:\\git-repository\\node-server\\node_modules\\redbox-react\\lib\\index.js');

var _index2 = _interopRequireDefault(_index);

var _index3 = require('E:\\git-repository\\node-server\\node_modules\\react-transform-catch-errors\\lib\\index.js');

var _index4 = _interopRequireDefault(_index3);

var _react2 = require('react');

var _react3 = _interopRequireDefault(_react2);

var _index5 = require('E:\\git-repository\\node-server\\node_modules\\react-transform-hmr\\lib\\index.js');

var _index6 = _interopRequireDefault(_index5);

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _dec, _class;

var _reactRedux = require('react-redux');

var _reactRouter = require('react-router');

var _echarts = require('echarts');

var _echarts2 = _interopRequireDefault(_echarts);

var _items = require('../actions/items');

var _immutable = require('immutable');

var _nav = require('../components/nav');

var _nav2 = _interopRequireDefault(_nav);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _components = {
  Default: {
    displayName: 'Default'
  }
};

var _EGitRepositoryNodeServerNode_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({
  filename: 'E:/git-repository/node-server/app/src/containers/default.js',
  components: _components,
  locals: [module],
  imports: [_react3.default]
});

var _EGitRepositoryNodeServerNode_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({
  filename: 'E:/git-repository/node-server/app/src/containers/default.js',
  components: _components,
  locals: [],
  imports: [_react3.default, _index2.default]
});

function _wrapComponent(id) {
  return function (Component) {
    return _EGitRepositoryNodeServerNode_modulesReactTransformHmrLibIndexJs2(_EGitRepositoryNodeServerNode_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);
  };
}

var styles = {
  h1: {
    color: 'red',
    fontSize: '50px',
    marginTop: '100px'
  },
  a: {
    color: '#fff'
  },
  table: {
    background: 'aquamarine',
    width: '500px'
  }
};

function mapStateToProps(state) {
  debugger;
  return {
    chartData: state.charts
  };
}

var Default = _wrapComponent('Default')((_dec = (0, _reactRedux.connect)(mapStateToProps, { loadDefaultChartData: _items.loadDefaultChartData, loadTestData: _items.loadTestData, loadNavs: _items.loadNavs }), _dec(_class = function (_Component) {
  _inherits(Default, _Component);

  _createClass(Default, null, [{
    key: 'fetchData',
    value: function fetchData(_ref) {
      var params = _ref.params;
      var query = _ref.query;

      console.log('参数为：' + params, query);
      // return store.dispatch(loadTestData())
      return [(0, _items.loadNavs)()]; //loadItems(params), loadTestData(), 
    }
  }]);

  function Default(props) {
    _classCallCheck(this, Default);

    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Default).call(this, props));

    _this.state = {
      showTable: false
    };
    _this.toggleNav = _this.toggleNav.bind(_this);
    return _this;
  }

  _createClass(Default, [{
    key: 'toggleNav',
    value: function toggleNav(type) {
      this.props.loadTestData();
      this.setState({
        showTable: true
      });
    }
  }, {
    key: 'componentDidMount',
    value: function componentDidMount() {
      this.props.loadDefaultChartData();
      //this.props.loadTestData()
      this.props.loadNavs();

      console.log(this.props);
    }
  }, {
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      debugger;
      if (this.props.chartData !== nextProps.chartData) {
        var data = nextProps.chartData;
        var charts = _echarts2.default.init(this.refs.charts);
        charts.setOption({
          title: {
            text: 'Echarts示例'
          },
          xAxis: {
            data: data.get('xData').toArray()
          },
          yAxis: {},
          series: [{
            name: '数量',
            type: 'bar',
            data: data.get('yData').toArray()
          }]
        });
      }
    }
  }, {
    key: 'render',
    value: function render() {
      var testData = this.props.chartData.get('test');
      console.log(testData);
      var state = testData.get('status');
      var data = testData.get('result');
      var message = testData.get('msg');

      var navs = this.props.chartData.get('navs');
      // console.log(state, data, message)
      return _react3.default.createElement(
        'div',
        { className: 'intro' },
        _react3.default.createElement(
          'h1',
          { style: styles.h1 },
          '\u793A\u4F8B\u9879\u76EE'
        ),
        _react3.default.createElement(_nav2.default, { clickLi: this.toggleNav, navs: navs }),
        _react3.default.createElement('div', { ref: 'charts', style: { width: 600, height: 400 } }),
        _react3.default.createElement(
          'div',
          null,
          _react3.default.createElement(
            'h2',
            null,
            message
          ),
          this.state.showTable ? _react3.default.createElement(
            'table',
            { style: styles.table },
            _react3.default.createElement(
              'thead',
              null,
              _react3.default.createElement(
                'tr',
                null,
                _react3.default.createElement(
                  'th',
                  null,
                  '\u5E8F\u53F7'
                ),
                _react3.default.createElement(
                  'th',
                  null,
                  '\u7528\u6237\u540D'
                ),
                _react3.default.createElement(
                  'th',
                  null,
                  '\u89D2\u8272'
                )
              )
            ),
            _react3.default.createElement(
              'tbody',
              null,
              data.map(function (col) {
                return _react3.default.createElement(
                  'tr',
                  { key: col.get('id') },
                  _react3.default.createElement(
                    'td',
                    null,
                    col.get('id')
                  ),
                  _react3.default.createElement(
                    'td',
                    null,
                    col.get('userName')
                  ),
                  _react3.default.createElement(
                    'td',
                    null,
                    col.get('role')
                  )
                );
              })
            )
          ) : ''
        ),
        _react3.default.createElement(
          _reactRouter.Link,
          { style: styles.a, to: '/list' },
          'Next Page(\u8DEF\u7531)'
        )
      );
    }
  }]);

  return Default;
}(_react2.Component)) || _class));

exports.default = Default;